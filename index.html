<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>World Clocks - Current Time & Timezone Converter</title>
<meta name="description" content="Clean and modern world clocks with analog and digital displays, timezone, daylight saving info, and time difference calculator." />
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f2f5;
    margin: 0; padding: 0;
    color: #333;
  }
  header {
    background: #005f73;
    color: white;
    padding: 1rem;
    text-align: center;
    font-size: 1.8rem;
    font-weight: 700;
  }
  main {
    max-width: 900px;
    margin: 1rem auto;
    padding: 0 1rem 3rem;
  }
  .clocks-container {
    display: flex;
    flex-wrap: wrap;
    gap: 1.5rem;
    justify-content: center;
    margin-bottom: 2rem;
  }
  .clock-card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 6px 12px rgb(0 0 0 / 0.1);
    padding: 1.5rem;
    width: 280px;
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
  }
  .clock-header {
    font-weight: 600;
    font-size: 1.3rem;
    margin-bottom: 0.3rem;
  }
  .clock-subtitle {
    font-size: 0.9rem;
    color: #666;
    margin-bottom: 1rem;
  }
  .remove-btn {
    position: absolute;
    top: 8px;
    right: 10px;
    background: #ee6c4d;
    border: none;
    border-radius: 50%;
    color: white;
    font-weight: bold;
    width: 26px;
    height: 26px;
    cursor: pointer;
    line-height: 22px;
  }
  .digital-clock {
    font-family: 'Courier New', Courier, monospace;
    font-size: 2rem;
    letter-spacing: 2px;
    margin-bottom: 1.5rem;
    color: #0a9396;
  }
  .analog-clock {
    width: 150px;
    height: 150px;
    border: 6px solid #94d2bd;
    border-radius: 50%;
    position: relative;
    background: white;
    box-shadow: inset 0 0 10px #b7d5d3;
  }
  .analog-clock .center {
    position: absolute;
    width: 14px;
    height: 14px;
    background: #005f73;
    border-radius: 50%;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
  }
  .hand {
    position: absolute;
    bottom: 50%;
    left: 50%;
    background: #005f73;
    transform-origin: bottom center;
    transform: rotate(0deg);
  }
  .hour-hand {
    width: 6px;
    height: 40px;
    border-radius: 6px 6px 0 0;
  }
  .minute-hand {
    width: 4px;
    height: 60px;
    border-radius: 4px 4px 0 0;
  }
  .second-hand {
    width: 2px;
    height: 70px;
    background: #ee6c4d;
    border-radius: 2px 2px 0 0;
  }
  /* Numbers around analog clock */
  .analog-clock .number {
    position: absolute;
    width: 22px;
    height: 22px;
    text-align: center;
    font-weight: 600;
    color: #005f73;
    font-size: 1rem;
    user-select: none;
  }
  /* Position numbers 1 to 12 */
  .number1  { top: 10%;  left: 70%; }
  .number2  { top: 20%;  left: 82%; }
  .number3  { top: 50%;  left: 90%; transform: translateY(-50%);}
  .number4  { top: 80%;  left: 82%; }
  .number5  { top: 90%;  left: 70%; }
  .number6  { top: 92%;  left: 50%; transform: translateX(-50%);}
  .number7  { top: 90%;  left: 30%; }
  .number8  { top: 80%;  left: 18%; }
  .number9  { top: 50%;  left: 10%; transform: translateY(-50%);}
  .number10 { top: 20%;  left: 18%; }
  .number11 { top: 10%;  left: 30%; }
  .number12 { top: 6%;   left: 50%; transform: translateX(-50%);}

  /* Add Clock Controls */
  .controls {
    max-width: 900px;
    margin: 0 auto 2rem;
    padding: 0 1rem;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.8rem;
  }
  select, button {
    font-size: 1rem;
    padding: 0.5rem 0.9rem;
    border-radius: 6px;
    border: 1.8px solid #ccc;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  button:hover {
    background-color: #0a9396;
    color: white;
    border-color: #0a9396;
  }

  /* Timezone Calculator */
  .calculator {
    background: white;
    border-radius: 12px;
    box-shadow: 0 6px 12px rgb(0 0 0 / 0.1);
    padding: 1.5rem;
    max-width: 600px;
    margin: 0 auto 3rem;
  }
  .calculator h2 {
    margin-top: 0;
    margin-bottom: 1rem;
    color: #005f73;
  }
  .calc-row {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 1rem;
  }
  .calc-row > * {
    flex: 1 1 130px;
    min-width: 130px;
  }
  input[type=date], input[type=time], select {
    width: 100%;
    box-sizing: border-box;
  }
  #calcResult {
    white-space: pre-wrap;
    font-family: monospace;
    background: #e0f7fa;
    padding: 1rem;
    border-radius: 8px;
    border: 1.5px solid #26a69a;
    min-height: 80px;
  }

  footer {
    text-align: center;
    color: #888;
    font-size: 0.9rem;
    padding: 1rem 0;
    border-top: 1px solid #ccc;
  }
</style>
</head>
<body>

<header>World Clocks — Current Time & Timezone Converter</header>

<main>

  <section class="clocks-container" id="clocksContainer">
    <!-- Clocks rendered here -->
  </section>

  <section class="controls">
    <select id="addClockSelect" aria-label="Select city to add clock">
      <option value="" disabled selected>Select a city to add clock</option>
    </select>
    <button id="addClockBtn">Add Clock</button>
  </section>

  <section class="calculator">
    <h2>Timezone & Time Difference Calculator</h2>
    <div class="calc-row">
      <select id="calcCity1" aria-label="Select first city"></select>
      <select id="calcCity2" aria-label="Select second city"></select>
    </div>
    <div class="calc-row">
      <input type="date" id="calcDate" aria-label="Select date" />
      <input type="time" id="calcTime" aria-label="Select time" step="60" />
    </div>
    <button id="calculateBtn">Calculate</button>
    <pre id="calcResult" aria-live="polite"></pre>
  </section>

</main>

<footer>
  Powered by LulssuLabs
</footer>

<script>
  // Cities list with id, display name, and IANA time zone
  const cities = [
    { id: 'america_new_york', name: 'New York, USA', tz: 'America/New_York' },
    { id: 'europe_london', name: 'London, UK', tz: 'Europe/London' },
    { id: 'asia_tokyo', name: 'Tokyo, Japan', tz: 'Asia/Tokyo' },
    { id: 'europe_paris', name: 'Paris, France', tz: 'Europe/Paris' },
    { id: 'asia_singapore', name: 'Singapore, Singapore', tz: 'Asia/Singapore' },
    { id: 'australia_sydney', name: 'Sydney, Australia', tz: 'Australia/Sydney' },
    { id: 'america_los_angeles', name: 'Los Angeles, USA', tz: 'America/Los_Angeles' },
    { id: 'europe_berlin', name: 'Berlin, Germany', tz: 'Europe/Berlin' },
    { id: 'america_chicago', name: 'Chicago, USA', tz: 'America/Chicago' },
    { id: 'asia_mumbai', name: 'Mumbai, India', tz: 'Asia/Kolkata' },
    // Add more as needed
  ];

  let currentClocks = [];

  const clocksContainer = document.getElementById('clocksContainer');
  const addClockSelect = document.getElementById('addClockSelect');
  const addClockBtn = document.getElementById('addClockBtn');

  const calcCity1 = document.getElementById('calcCity1');
  const calcCity2 = document.getElementById('calcCity2');
  const calcDate = document.getElementById('calcDate');
  const calcTime = document.getElementById('calcTime');
  const calculateBtn = document.getElementById('calculateBtn');
  const calcResult = document.getElementById('calcResult');

  function formatDateTime(date, timeZone) {
    return new Intl.DateTimeFormat('en-GB', {
      timeZone,
      year: 'numeric', month: '2-digit', day: '2-digit',
      hour: '2-digit', minute: '2-digit', second: '2-digit',
      hour12: false
    }).format(date);
  }

  // Render clocks on page
  function renderClocks() {
    clocksContainer.innerHTML = '';
    for (const city of currentClocks) {
      const clockCard = document.createElement('div');
      clockCard.className = 'clock-card';

      const removeBtn = document.createElement('button');
      removeBtn.className = 'remove-btn';
      removeBtn.textContent = '×';
      removeBtn.title = 'Remove clock';
      removeBtn.onclick = () => {
        currentClocks = currentClocks.filter(c => c.id !== city.id);
        renderClocks();
      };

      const header = document.createElement('div');
      header.className = 'clock-header';
      header.textContent = city.name;

      const subtitle = document.createElement('div');
      subtitle.className = 'clock-subtitle';
      subtitle.textContent = city.tz;

      const digitalClock = document.createElement('div');
      digitalClock.className = 'digital-clock';
      digitalClock.id = `digital-${city.id}`;

      const analogClock = createAnalogClock(city.id);

      clockCard.appendChild(removeBtn);
      clockCard.appendChild(header);
      clockCard.appendChild(subtitle);
      clockCard.appendChild(digitalClock);
      clockCard.appendChild(analogClock);
      clocksContainer.appendChild(clockCard);
    }
  }

  // Create analog clock with numbers
  function createAnalogClock(id) {
    const clock = document.createElement('div');
    clock.className = 'analog-clock';
    clock.id = `analog-${id}`;

    // Hour hand
    const hourHand = document.createElement('div');
    hourHand.className = 'hand hour-hand';
    hourHand.id = `hour-hand-${id}`;
    clock.appendChild(hourHand);

    // Minute hand
    const minuteHand = document.createElement('div');
    minuteHand.className = 'hand minute-hand';
    minuteHand.id = `minute-hand-${id}`;
    clock.appendChild(minuteHand);

    // Second hand
    const secondHand = document.createElement('div');
    secondHand.className = 'hand second-hand';
    secondHand.id = `second-hand-${id}`;
    clock.appendChild(secondHand);

    // Center dot
    const center = document.createElement('div');
    center.className = 'center';
    clock.appendChild(center);

    // Numbers 1 to 12
    for (let n = 1; n <= 12; n++) {
      const num = document.createElement('div');
      num.className = `number number${n}`;
      num.textContent = n;
      clock.appendChild(num);
    }
    return clock;
  }

  // Update all clocks every second
  function updateAllClocks() {
    const now = new Date();
    for (const city of currentClocks) {
      // Digital clock update
      const digital = document.getElementById(`digital-${city.id}`);
      if (digital) {
        digital.textContent = formatDateTime(now, city.tz);
      }
      // Analog clock update
      updateAnalogClock(now, city);
    }
  }

  function updateAnalogClock(date, city) {
    // Get time in city's timezone
    const timeStr = date.toLocaleString('en-US', {
      timeZone: city.tz,
      hour12: false,
      hour: '2-digit', minute: '2-digit', second: '2-digit'
    });
    const [hour, minute, second] = timeStr.split(':').map(Number);

    const hourDeg = ((hour % 12) + minute / 60) * 30; // 360/12 = 30 degrees per hour
    const minuteDeg = (minute + second / 60) * 6;     // 360/60 = 6 degrees per minute
    const secondDeg = second * 6;                      // 6 degrees per second

    const hourHand = document.getElementById(`hour-hand-${city.id}`);
    const minuteHand = document.getElementById(`minute-hand-${city.id}`);
    const secondHand = document.getElementById(`second-hand-${city.id}`);

    if (hourHand) hourHand.style.transform = `rotate(${hourDeg}deg)`;
    if (minuteHand) minuteHand.style.transform = `rotate(${minuteDeg}deg)`;
    if (secondHand) secondHand.style.transform = `rotate(${secondDeg}deg)`;
  }

  // Populate city selects with cities not already in clocks (for addClockSelect)
  function populateAddClockSelect() {
    addClockSelect.innerHTML = '<option value="" disabled selected>Select a city to add clock</option>';
    for (const city of cities) {
      if (!currentClocks.some(c => c.id === city.id)) {
        const option = document.createElement('option');
        option.value = city.id;
        option.textContent = city.name;
        addClockSelect.appendChild(option);
      }
    }
  }

  // Populate calculator selects with all cities
  function populateCalculatorSelects() {
    calcCity1.innerHTML = '';
    calcCity2.innerHTML = '';
    for (const city of cities) {
      const option1 = document.createElement('option');
      option1.value = city.id;
      option1.textContent = city.name;
      calcCity1.appendChild(option1);

      const option2 = document.createElement('option');
      option2.value = city.id;
      option2.textContent = city.name;
      calcCity2.appendChild(option2);
    }
    // Set defaults
    calcCity1.value = 'america_new_york';
    calcCity2.value = 'europe_london';
  }

  // Calculate timezone difference and converted time
  function calculateTimeDifference() {
    const city1 = cities.find(c => c.id === calcCity1.value);
    const city2 = cities.find(c => c.id === calcCity2.value);

    if (!city1 || !city2) {
      calcResult.textContent = 'Please select both cities.';
      return;
    }

    const dateVal = calcDate.value;
    const timeVal = calcTime.value;

    if (!dateVal || !timeVal) {
      calcResult.textContent = 'Please select both date and time.';
      return;
    }

    // Combine date and time into a Date object (in local time)
    const localDateTime = new Date(`${dateVal}T${timeVal}:00`);

    if (isNaN(localDateTime.getTime())) {
      calcResult.textContent = 'Invalid date or time.';
      return;
    }

    // Convert localDateTime to UTC milliseconds for calculations
    const utcMillis = localDateTime.getTime() - localDateTime.getTimezoneOffset() * 60000;

    // Get offset for each city at the given date/time in minutes
    const offset1 = getTimezoneOffsetMinutes(city1.tz, localDateTime);
    const offset2 = getTimezoneOffsetMinutes(city2.tz, localDateTime);

    // Calculate time difference in hours
    const diffMinutes = offset2 - offset1;
    const diffHours = diffMinutes / 60;

    // Calculate city2 time based on city1 local date/time + diff
    const city2DateTime = new Date(localDateTime.getTime() + diffMinutes * 60000);

    // Display result
    const city1Formatted = formatDateTime(localDateTime, city1.tz);
    const city2Formatted = formatDateTime(city2DateTime, city2.tz);

    let diffSign = diffHours > 0 ? '+' : '';
    const diffStr = `${diffSign}${diffHours} hour${diffHours === 1 || diffHours === -1 ? '' : 's'}`;

    const dst1 = isDST(city1.tz, localDateTime) ? 'Yes' : 'No';
    const dst2 = isDST(city2.tz, city2DateTime) ? 'Yes' : 'No';

    calcResult.textContent =
`From (${city1.name}, ${city1.tz}):
  Date & Time: ${city1Formatted}
  Daylight Saving: ${dst1}

To   (${city2.name}, ${city2.tz}):
  Date & Time: ${city2Formatted}
  Daylight Saving: ${dst2}

Time difference: ${diffStr}
`;
  }

  // Helper: Get offset in minutes for a timezone at a given date (including DST)
  function getTimezoneOffsetMinutes(timeZone, date) {
    // Use Intl API with formatToParts to get offset
    // Create a formatted string of the offset in minutes from UTC
    const dtf = new Intl.DateTimeFormat('en-US', {
      timeZone,
      hour12: false,
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      timeZoneName: 'shortOffset'
    });
    const parts = dtf.formatToParts(date);
    const tzOffsetPart = parts.find(p => p.type === 'timeZoneName');
    // tzOffsetPart.value example: "GMT+3" or "GMT-5"
    if (!tzOffsetPart) return 0;

    const match = tzOffsetPart.value.match(/GMT([+-]\d{1,2})(?::?(\d{2}))?/);
    if (!match) return 0;

    const hours = parseInt(match[1], 10);
    const minutes = match[2] ? parseInt(match[2], 10) : 0;
    return hours * 60 + minutes;
  }

  // Check if date is in DST for a given timezone (simple check)
  function isDST(timeZone, date) {
    const jan = new Date(date.getFullYear(), 0, 1);
    const jul = new Date(date.getFullYear(), 6, 1);
    const stdOffset = Math.max(getTimezoneOffsetMinutes(timeZone, jan), getTimezoneOffsetMinutes(timeZone, jul));
    const currentOffset = getTimezoneOffsetMinutes(timeZone, date);
    return currentOffset < stdOffset;
  }

  // Add clock button handler
  addClockBtn.onclick = () => {
    const selectedId = addClockSelect.value;
    if (!selectedId) return;
    if (!currentClocks.some(c => c.id === selectedId)) {
      const city = cities.find(c => c.id === selectedId);
      if (city) {
        currentClocks.push(city);
        renderClocks();
        populateAddClockSelect();
      }
    }
  };

  // Calculate button handler
  calculateBtn.onclick = () => {
    calculateTimeDifference();
  };

  // Initialize with default clocks
  function init() {
    currentClocks = cities.filter(c => ['america_new_york', 'europe_london', 'asia_tokyo'].includes(c.id));
    renderClocks();
    populateAddClockSelect();
    populateCalculatorSelects();

    // Set date and time inputs to current local date/time
    const now = new Date();
    calcDate.value = now.toISOString().slice(0, 10);
    calcTime.value = now.toTimeString().slice(0, 5);

    // Start clock updates
    setInterval(updateAllClocks, 1000);
    updateAllClocks();
  }

  init();

</script>

</body>
</html>
