<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="World Clock - Compare current time and daylight saving info for cities worldwide with analog & digital clocks." />
<title>World Clock - Timezone Converter & Daylight Saving Info</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap');

  /* Reset and basics */
  body {
    margin: 0;
    font-family: 'Roboto Mono', monospace, monospace;
    background: #f0f2f5;
    color: #333;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  header {
    background-color: #3f51b5;
    color: white;
    padding: 1rem 2rem;
    text-align: center;
    font-size: 1.8rem;
    font-weight: 700;
  }

  main {
    flex: 1;
    padding: 1.5rem 2rem;
    display: flex;
    flex-wrap: wrap;
    gap: 1.5rem;
    justify-content: center;
  }

  /* Card container for each clock */
  .clock-card {
    background: white;
    border-radius: 16px;
    box-shadow: 0 4px 16px rgb(0 0 0 / 0.1);
    width: 280px;
    padding: 20px;
    user-select: none;
    position: relative;
    cursor: grab;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .clock-card.dragging {
    opacity: 0.7;
    cursor: grabbing;
  }

  /* Analog clock container */
  .analog-clock {
    position: relative;
    width: 180px;
    height: 180px;
    border: 6px solid #3f51b5;
    border-radius: 50%;
    background: #fafafa;
    margin-bottom: 1rem;
    box-shadow: inset 0 0 8px #bbb;
  }

  /* Clock numbers */
  .analog-clock .number {
    position: absolute;
    font-weight: 600;
    color: #3f51b5;
    font-size: 1.1rem;
    user-select: none;
  }

  /* Position numbers with transform */
  /* Positions are calculated around circle center (90,90) */
  /* Using 12 numbers positioned by their angle */
  .num1 { top: 20px; left: 138px; }
  .num2 { top: 42px; left: 160px; }
  .num3 { top: 82px; left: 170px; }
  .num4 { top: 122px; left: 160px; }
  .num5 { top: 143px; left: 138px; }
  .num6 { top: 153px; left: 88px; }
  .num7 { top: 143px; left: 38px; }
  .num8 { top: 122px; left: 18px; }
  .num9 { top: 82px; left: 8px; }
  .num10 { top: 42px; left: 18px; }
  .num11 { top: 20px; left: 38px; }
  .num12 { top: 10px; left: 88px; }

  /* Hands */
  .hand {
    position: absolute;
    background: #3f51b5;
    top: 90px;
    left: 90px;
    transform-origin: bottom center;
    transition: transform 0.3s ease-in-out;
  }
  .hand.hour {
    width: 6px;
    height: 50px;
    border-radius: 3px;
    top: 90px;
    left: 87px;
  }
  .hand.minute {
    width: 4px;
    height: 70px;
    border-radius: 2px;
    top: 90px;
    left: 88px;
  }
  .hand.second {
    width: 2px;
    height: 80px;
    background: #e91e63;
    top: 90px;
    left: 89px;
  }

  /* Center pivot */
  .center-dot {
    position: absolute;
    width: 12px;
    height: 12px;
    background: #3f51b5;
    border-radius: 50%;
    top: 84px;
    left: 84px;
    box-shadow: 0 0 4px #2c387e;
  }

  /* Digital time display */
  .digital-time {
    font-size: 1.5rem;
    font-weight: 700;
    letter-spacing: 1px;
    margin-bottom: 0.25rem;
  }

  /* City and timezone info */
  .city {
    font-size: 1.1rem;
    font-weight: 600;
    color: #555;
  }
  .timezone {
    font-size: 0.85rem;
    color: #777;
    margin-bottom: 0.6rem;
  }
  .dst {
    font-size: 0.85rem;
    color: #c62828;
    font-weight: 600;
  }

  /* Controls */
  #addClockForm {
    margin: 1rem auto 2rem;
    max-width: 600px;
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }
  #addClockForm input[type="text"] {
    padding: 0.5rem 1rem;
    font-size: 1rem;
    border: 2px solid #3f51b5;
    border-radius: 8px;
    width: 220px;
  }
  #addClockForm button {
    background-color: #3f51b5;
    color: white;
    border: none;
    padding: 0.6rem 1.5rem;
    font-size: 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  #addClockForm button:hover {
    background-color: #2c387e;
  }

  /* Footer */
  footer {
    text-align: right;
    padding: 0.75rem 1rem;
    font-size: 0.85rem;
    color: #666;
    background-color: #fafafa;
    user-select: none;
  }

  /* Light/Dark toggle */
  #themeToggle {
    position: fixed;
    top: 12px;
    right: 12px;
    background-color: #3f51b5;
    border: none;
    color: white;
    font-weight: 700;
    border-radius: 12px;
    padding: 0.3rem 1rem;
    cursor: pointer;
    box-shadow: 0 3px 8px rgb(0 0 0 / 0.3);
    z-index: 9999;
    transition: background-color 0.3s ease;
  }
  #themeToggle:hover {
    background-color: #2c387e;
  }

  /* Dark mode styles */
  body.dark {
    background: #121212;
    color: #eee;
  }
  body.dark header {
    background-color: #1e1e1e;
    color: #eee;
  }
  body.dark .clock-card {
    background: #222;
    box-shadow: 0 4px 16px rgb(255 255 255 / 0.05);
    color: #eee;
  }
  body.dark .analog-clock {
    background: #333;
    border-color: #bb86fc;
    box-shadow: inset 0 0 10px #bb86fc;
  }
  body.dark .analog-clock .number {
    color: #bb86fc;
  }
  body.dark .hand.hour,
  body.dark .hand.minute,
  body.dark .center-dot {
    background: #bb86fc;
    box-shadow: 0 0 10px #bb86fc;
  }
  body.dark .hand.second {
    background: #cf6679;
    box-shadow: 0 0 10px #cf6679;
  }
  body.dark #addClockForm input[type="text"] {
    background-color: #333;
    border-color: #bb86fc;
    color: #eee;
  }
  body.dark #addClockForm button {
    background-color: #bb86fc;
    color: #121212;
  }
  body.dark #addClockForm button:hover {
    background-color: #9a67ea;
  }
  body.dark footer {
    background-color: #1e1e1e;
    color: #aaa;
  }

  /* Remove input outline on focus but keep accessibility */
  #addClockForm input[type="text"]:focus {
    outline: 2px solid #3f51b5;
  }

  /* Remove number input arrows on some browsers */
  input::-webkit-outer-spin-button,
  input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  input[type=number] {
    -moz-appearance: textfield;
  }
</style>
</head>
<body>

<header>World Clock - Timezone Converter & Daylight Saving Info</header>

<button id="themeToggle" aria-label="Toggle dark mode">Dark Mode</button>

<form id="addClockForm" aria-label="Add a city clock">
  <input id="cityInput" type="text" placeholder="Enter city, e.g. Berlin" aria-label="City name" required />
  <input id="countryInput" type="text" placeholder="Enter country, e.g. Germany" aria-label="Country name" required />
  <button type="submit">Add Clock</button>
</form>

<main id="clocksContainer" aria-live="polite" aria-relevant="additions removals">
  <!-- Clocks inserted here dynamically -->
</main>

<footer>Powered by LulssuLabs</footer>

<script>
  // Data: initial clocks
  let clocks = [
    { id: 1, city: "New York", country: "USA" },
    { id: 2, city: "London", country: "UK" },
    { id: 3, city: "Tokyo", country: "Japan" }
  ];
  let nextId = 4;

  const clocksContainer = document.getElementById("clocksContainer");
  const addClockForm = document.getElementById("addClockForm");
  const cityInput = document.getElementById("cityInput");
  const countryInput = document.getElementById("countryInput");
  const themeToggle = document.getElementById("themeToggle");

  // Helper: get timezone offset string e.g. UTC+2 or UTC-5
  function getUTCOffsetString(date, tz) {
    try {
      const options = { timeZone: tz, hour12: false, timeZoneName: 'short' };
      const formatter = new Intl.DateTimeFormat('en-US', options);
      const parts = formatter.formatToParts(date);
      let tzName = parts.find(p => p.type === 'timeZoneName')?.value || "";
      // Normalize to "UTCÂ±X"
      if (/GMT/.test(tzName)) {
        tzName = tzName.replace("GMT", "UTC");
      }
      return tzName;
    } catch {
      return "";
    }
  }

  // Helper: get timezone name from city and country using Intl API (best effort)
  function getTimeZoneId(city, country) {
    // For demo, we use a basic lookup table. For real app use external API or IANA database.
    const tzMap = {
      "New York,USA": "America/New_York",
      "London,UK": "Europe/London",
      "Tokyo,Japan": "Asia/Tokyo",
      "Berlin,Germany": "Europe/Berlin",
      "Paris,France": "Europe/Paris",
      "Sydney,Australia": "Australia/Sydney",
      "Moscow,Russia": "Europe/Moscow",
      "Dubai,UAE": "Asia/Dubai",
      "Beijing,China": "Asia/Shanghai",
      "Los Angeles,USA": "America/Los_Angeles",
      "Chicago,USA": "America/Chicago",
      "Toronto,Canada": "America/Toronto",
      "Delhi,India": "Asia/Kolkata",
      "Mexico City,Mexico": "America/Mexico_City"
      // Add more if needed
    };
    let key = `${city.trim()},${country.trim()}`;
    if (key in tzMap) return tzMap[key];
    return Intl.DateTimeFormat().resolvedOptions().timeZone; // fallback to local
  }

  // Build analog clock face numbers HTML
  function buildAnalogNumbers() {
    let html = '';
    for (let i = 1; i <= 12; i++) {
      html += `<div class="number num${i}">${i}</div>`;
    }
    return html;
  }

  // Create clock card HTML
  function createClockCard(clock) {
    const tz = getTimeZoneId(clock.city, clock.country);
    const now = new Date();

    // Initial time in that timezone
    const timeString = now.toLocaleTimeString('en-US', { timeZone: tz, hour12: false, hour: "2-digit", minute: "2-digit", second: "2-digit" });

    // Offset and DST info
    const offsetString = getUTCOffsetString(now, tz);
    const isDST = isDaylightSavingTime(now, tz);
    const dstText = isDST ? " (DST)" : "";

    return `
      <article class="clock-card" data-id="${clock.id}" draggable="true" aria-label="Clock for ${clock.city}, ${clock.country}">
        <div class="analog-clock" aria-hidden="true">
          ${buildAnalogNumbers()}
          <div class="hand hour"></div>
          <div class="hand minute"></div>
          <div class="hand second"></div>
          <div class="center-dot"></div>
        </div>
        <div class="digital-time">${timeString}</div>
        <div class="city">${clock.city}, ${clock.country}</div>
        <div class="timezone">${offsetString}${dstText}</div>
        <button class="remove-btn" aria-label="Remove clock for ${clock.city}" style="position:absolute; top:8px; right:8px; background:#e53935; border:none; color:#fff; border-radius:8px; padding:2px 6px; cursor:pointer;">â</button>
      </article>
    `;
  }

  // Detect DST for a given date & timezone (best effort)
  // DST usually changes offset compared to standard time
  function isDaylightSavingTime(date, tz) {
    try {
      const stdOffset = new Date(date.getFullYear(), 0, 1).toLocaleTimeString('en-US', { timeZone: tz, timeZoneName: 'short' }).split(' ')[2];
      const summerOffset = new Date(date.getFullYear(), 6, 1).toLocaleTimeString('en-US', { timeZone: tz, timeZoneName: 'short' }).split(' ')[2];
      const currentOffset = date.toLocaleTimeString('en-US', { timeZone: tz, timeZoneName: 'short' }).split(' ')[2];
      return currentOffset !== stdOffset;
    } catch {
      return false;
    }
  }

  // Render all clocks to container
  function renderClocks() {
    clocksContainer.innerHTML = clocks.map(createClockCard).join('');
    addRemoveListeners();
    addDragListeners();
  }

  // Update clock hands and digital times every second
  function updateClocks() {
    clocks.forEach(clock => {
      const card = clocksContainer.querySelector(`.clock-card[data-id="${clock.id}"]`);
      if (!card) return;

      const tz = getTimeZoneId(clock.city, clock.country);
      const now = new Date();

      // Get localized time parts
      const timeParts = new Intl.DateTimeFormat('en-US', {
        hour12: false,
        hour: 'numeric',
        minute: 'numeric',
        second: 'numeric',
        timeZone: tz
      }).formatToParts(now);

      let hour = 0, minute = 0, second = 0;
      for (const part of timeParts) {
        if (part.type === 'hour') hour = parseInt(part.value, 10);
        else if (part.type === 'minute') minute = parseInt(part.value, 10);
        else if (part.type === 'second') second = parseInt(part.value, 10);
      }

      // Calculate angles for analog hands
      const hourAngle = (hour % 12) * 30 + minute * 0.5; // 30 deg per hour + 0.5 per minute
      const minuteAngle = minute * 6; // 6 deg per minute
      const secondAngle = second * 6; // 6 deg per second

      // Rotate hands
      card.querySelector('.hand.hour').style.transform = `rotate(${hourAngle}deg) translateY(-50%)`;
      card.querySelector('.hand.minute').style.transform = `rotate(${minuteAngle}deg) translateY(-50%)`;
      card.querySelector('.hand.second').style.transform = `rotate(${secondAngle}deg) translateY(-50%)`;

      // Update digital time string
      const timeString = now.toLocaleTimeString('en-US', { timeZone: tz, hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit' });
      card.querySelector('.digital-time').textContent = timeString;

      // Update DST text
      const offsetString = getUTCOffsetString(now, tz);
      const
